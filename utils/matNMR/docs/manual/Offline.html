<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

	<link rel=stylesheet type="text/css" href="Manual.css">

	<title>matNMR Manual Page: Offline Processing</title>

	<script type="text/javascript">
	<!--
	window.defaultStatus ="Remember: if you want flexibility, matNMR is the right choice!"
	// -->
	</script>
</head>

<body>
<a name="Intro"></a><h1>
Chapter 8 - Script-based processing with matNMR</h1>

<p><b>NOTE: These routines still have not been tested enough yet and can contain minor bugs. Please report any bugs that you find!</b></p>

<p>It is also possible to use the processing facilities of matNMR in user-defined scripts. A number, but not all, processing
actions have been created into separate functions that do not require the matNMR GUI to be open. They are, separated by
mode:<br></p>

<table border=yes align=center>
<tr>
<th>Mode-independent</th>
<th>1D Processing</th><th>2D Processing</th>
</tr>

<tr>
<td>
<ul>
<li>matNMRReadBinaryFID</li>
<li>matNMRReadBrukerSpectra</li>
<li>matNMRReadSIMPSONASCII</li>
<li>matNMRTranspose</li>
</ul>
</td>

<td>
<ul>
<li>matNMRApodize1D</li>
<li>matNMRBaselineCorrection1D</li>
<li>matNMRConcatenate1D</li>
<li>matNMRConvertBrukerqseq1D</li>
<li>matNMRDCcorr1D</li>
<li>matNMRExtract1D</li>
<li>matNMRFlip1D</li>
<li>matNMRFT1D</li>
<li>matNMRLeftShift1D</li>
<li>matNMRLP1D</li>
<li>matNMRRegridSpectrum1D</li>
<li>matNMRRemoveBrukerDigitalFilter1D</li>
<li>matNMRSetPhase1D</li>
<li>matNMRSetSize1D</li>
<li>matNMRSolventSuppression1D</li>
<li>matNMRSwapEcho1D</li>
</ul>
</td>

<td>
<ul>
<li>matNMRApodize2D</li>
<li>matNMRConcatenate2D</li>
<li>matNMRConvertBrukerqseq2D</li>
<li>matNMRConvertEAE2D</li>
<li>matNMRConvertStates2D</li>
<li>matNMRDCcorr2D</li>
<li>matNMRExtract2D</li>
<li>matNMRFlip2D</li>
<li>matNMRFT2D</li>
<li>matNMRLeftShift2D</li>
<li>matNMRLP2D</li>
<li>matNMRRegridSpectrum2D</li>
<li>matNMRRemoveBrukerDigitalFilter2D</li>
<li>matNMRSetPhase2D</li>
<li>matNMRSetSize2D</li>
<li>matNMRShearingTransformationFD</li>
<li>matNMRShearingTransformationTD</li>
<li>matNMRSolventSuppression2D</li>
<li>matNMRSymmetrize2D</li>
<li>matNMRSwapEcho2D</li>
</ul>
</td>
</tr>
</table>

<p>The names should be self-explanatory in terms of what the functions do. The syntax for each function
can be obtained by typing <b><i><font size="+1">help "Name Function"</font></i></b> in the Matlab command window. This should
provide ample information. All the above-mentioned routines operate on matrices only and not on
(matNMR) structures! In most cases, processing of hypercomplex matrices is not supported in the sense
that both matrices cannot be entered at the same time, but must be called sequentially from the
user-defined script.</p>

<p>It is possible to convert macros to scripts directly from the GUI. This currently only works for 1D actions but
this will soon be extended to 2D actions as well.</p>

<p>Note that although most things can be done this way, baseline correction is not (yet) supported
as this requires input of peak positions in matNMR. Furthermore, no spectral information is maintained
by these functions.</p>

<p>Finally, an additional way of using matNMR in user-defined scripts is to record processing and/or plotting
macro's, which can then be called by the function <b><i>matNMRRunMacro</i></b>. Again, the
syntax to this function can be called by typing <b><i><font size="+1">help matNMRRunMacro</font></i></b> in
the Matlab command window. This function does require matNMR windows to be open but doesn't rely on user input
whilst processing, i.e. even though changes are made to the matNMR windows they may be hidden from view.
This function can be used to either process a spectrum using a macro, OR to execute a plotting macro on the
current window.
</p>

<p>Here's an example of how one could use matNMRRunMacro in a script:<br><br>

<dd>%</dd>
<dd>%example how to use matNMRRunMacro:</dd>
<dd>%</dd>
<dd>%This file loads all files from the current directory with names Epsilon$#$ where $#$ is a range from 0 to 90.</dd>
<dd>%The FIDs are then processed by macro "m" which was saved in file "Macro.mat". The output variable is called "Spec".</dd>
<dd>%</dd>

<br>
<dd>MacroFile = 'Macro';</dd>
<dd>MacroName = 'm';</dd>
<dd>Range = 0:90;</dd>
<br>
<dd>%load file with processing macro</dd>
<dd>eval(['load ' MacroFile]);</dd>
<br>
<dd>%start matNMR</dd>
<dd>nmr</dd>
<br>
<dd>for tel1 = 1:length(Range)</dd>
<dd>  %load file</dd>
<dd>  eval(['load Epsilon' num2str(Range(tel1))]);</dd>
<br>
<dd>  %process the FID</dd>
<dd>  eval(['MatrixOut = matNMRRunMacro(Epsilon' num2str(Range(tel1)) ', ' MacroName ');']);</dd>
<br>
<dd>  %create spectral matrix in first iteration</dd>
<dd>  if (tel1 == 1)</dd>
<dd>    [x, y] = size(MatrixOut.Spectrum);</dd>
<dd>    Spec = zeros(length(Range), x, y);</dd>
<dd>  end</dd>
<br>
<dd>  %fill in the matrix</dd>
<dd>  Spec(tel1, :, :) = MatrixOut.Spectrum;</dd>
<br>
<dd>  %clear FID from memory</dd>
<dd>  eval(['clear Epsilon' num2str(Range(tel1))]);</dd>
<dd>end</dd>
<br><br>

</p>

<p>
  <a href="http://validator.w3.org/check?uri=referer"><img border="0"
      src="http://www.w3.org/Icons/valid-html401"
      alt="Valid HTML 4.01!" height="31" width="88"></a>
</p>
</body>
</html>
